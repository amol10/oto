<html>
    <head>
        <script type="text/javscript">
            function play() {
            var audio = new Audio("file://ding2.mp3");
            audio.play();
            }
            window.onload = play;
        </script>
        <script src="howler.js"></script>
        <script src="jquery-3.6.0.js"></script>
        <script src="bootstrap.min.js"></script>
        <link rel="stylesheet" href="bootstrap.min.css">
    </head>
    <body>
        <!-- <Audio id="ding2" src="file://ding2.mp3"></Audio> -->
        <script>
            //document.getElementById("ding2").play();
            /*function sleep (time) {
                return new Promise((resolve) => setTimeout(resolve, time));
            }
            //sleep(3).then(() => {
            function play2() {
            var audio = new Audio("ding2.mp3");
            audio.play();
            setTimeout(play2, 10000);
            }

            play2();
            /*while (true) {
                setTimeout(play2, 3000);
            }*/
            
        </script>

        <!-- <label for="ding2">
            <input type="checkbox" id="ding2" data="ding2.mp3" name="ding2"> ding2
        </label> -->

        <script>
            //<sed replace
			var sounds = {
			"censor1": { file: "sounds/censor1.mp3", mdelay: 60 },
			"clink-fart-med": { file: "sounds/clink-fart-med.mp3", mdelay: 60 },
			"cough1": { file: "sounds/cough1.mp3", mdelay: 60 },
			"ding2": { file: "sounds/ding2.mp3", mdelay: 60 },
			"drum2": { file: "sounds/drum2.mp3", mdelay: 60 },
			"engineer_no_1": { file: "sounds/engineer_no_1.mp3", mdelay: 60 },
			"evillaugh": { file: "sounds/evillaugh.mp3", mdelay: 60 },
			"hammer1": { file: "sounds/hammer1.mp3", mdelay: 60 },
			"left_4_dead_witch_01": { file: "sounds/left_4_dead_witch_01.mp3", mdelay: 60 },
			"movie_1": { file: "sounds/movie_1.mp3", mdelay: 60 },
			"scream7": { file: "sounds/scream7.mp3", mdelay: 60 },
			"tool_cooker": { file: "sounds/tool_cooker.mp3", mdelay: 60 },
			"trapbuzz": { file: "sounds/trapbuzz.mp3", mdelay: 60 },
			}
			//sed replace>
        </script>

        <script>
            window.muteSounds = false;
            function shutdown() {
                console.log("in shutdown");
                for (var sound in sounds) {
                    console.log(sound);
                    jQuery("#" + sound).prop("checked", false);
                }
            }

            function mute() {
                if (window.muteSounds == false) {
                    window.muteSounds = true;
                    jQuery("#mute").prop("value", "Unmute");
                } else {
                    window.muteSounds = false;
                    jQuery("#mute").prop("value", "Mute");
                }
            }

            function chaos() {
                if (confirm("Are you sure?")) {
                    for (var sound in sounds) {
                        jQuery("#" + sound).prop("checked", true);
                        jQuery("#" + sound + "-mdelay").prop("value", parseInt(Math.random() * 30));
                    }
                }
            }
        </script>

        <div id="controls">
            <input type="button" onclick="shutdown()" class="btn btn-primary btn-sm" id="shutdown" value="Shutdown">
            <input type="button" onclick="mute()" class="btn btn-primary btn-sm" id="mute" value="Mute">
            <input type="button" onclick="chaos()" class="btn btn-primary btn-sm" id="chaos" value="Chaos">
        </div>

        <br>

        <div id="sounds" class="form-check">
            <table id="sounds-table">

            </table>
        </div>

        <script>
            

            for (var sound in sounds) {
                var s = sounds[sound];
                console.log(s);

                var tr = jQuery("<tr>", {}).appendTo("#sounds-table");
                
                var td = jQuery("<td>", {}).appendTo(tr);
                jQuery("<input>", {
                    id: sound,
                    type: "checkbox",
                    class: "form-check-input"
                }).appendTo(td);

                var td = jQuery("<td>", {}).appendTo(tr);
                jQuery("<label>", {
                    for: sound,
                    text: sound
                }).appendTo(td);

                var td = jQuery("<td>", {}).appendTo(tr);
                jQuery("<input>", {
                    id: sound + "-mdelay",
                    type: "text",
                    size: 1,
                    style: "text-align:right",
                    value: sounds[sound]["mdelay"]
                }).appendTo(td);

                //jQuery("<br>").appendTo("#sounds");
                //$("#sounds").append("<label for=\"" + sound + "\">" + sound + "</label><br>");
            }
        </script>

        <script>
            /*jQuery.get("data://list.txt", function(data) {
                console.log(data);
            });*/
            console.log("script")
            function checker() {
                /*if (document.querySelector("#ding2:checked") !== null) {
                    console.log("in checker if")
                    var ding2 = new Audio("ding2.mp3");
                    ding2.play();
                    setTimeout(checker, 1000);
                    return;
                }
                setTimeout(checker, 1000);*/

                for (var sound in sounds) {
                    if (window.muteSounds) {
                        continue;
                    }
                    if (document.querySelector("#" + sound + ":checked") !== null) {
                        //console.log("checked");
                        sounds[sound]["mdelay"] = parseInt(jQuery("#" + sound + "-mdelay")[0].value);
                        //console.log(sound, sounds[sound]["mdelay"], sounds[sound]["sleep"]);
                        if (isNaN(sounds[sound]["sleep"])) {
                            sounds[sound]["sleep"] = parseInt(Math.random() * sounds[sound]["mdelay"]);
                            continue;
                        }
                        if (sounds[sound]["sleep"] == 0) {
                            var s = new Audio(sounds[sound]["file"]);
                            s.play();
                            sounds[sound]["sleep"] = parseInt(Math.random() * sounds[sound]["mdelay"]);
                        } else {
                            sounds[sound]["sleep"]--;
                        }
                    }
                }
                setTimeout(checker, 1000);
            }
            checker()
          
        </script>

        <audio controls>
            <source src="sounds/ding2.mp3" type="audio/mpeg">
        </audio>

        <!-- <script>
            var sound = new Howl({
            src: ['ding2.mp3'],
            onplayerror: function() {
              sound.once('unlock', function() {
                sound.play();
              });
            }
          });
          
          sound.play();
        
        </script> -->


        <!-- <script>
            sleep(3).then(() => {
                var sound = new Howl({
                    src: ['ding2.mp3'],
                    autoplay: true
                });
            });
        </script> -->
          
          

    </body>
</html> 